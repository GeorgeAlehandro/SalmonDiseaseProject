---
title: "SalmonDiseaseDataExploration"
author: "SAAD George Alehandro"
date: "10/5/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 60), tidy = TRUE)

#### LOADING THE DATA ########

library("openxlsx")

data_experience <-openxlsx::read.xlsx("/home/gabi/MASTER/bio_info/M2/math/proyecto/SalmonDiseaseProject/DISEASES_MATRIX_English_01.xlsx")

####### DATA "NORMALIZATION" (First from Rows, then from columns) ########## 

normalization_signs <- function(data){
data <- cbind(data, Total = rowSums(data[6:27]))

for (x in 1:nrow(data)){
  for(y in 6:27){
    data[x,y] <- (data[x,y]/data[x,28])
  }
}

columns_sums = colSums(data[,6:28])
Total = append(c(NaN,NaN,NaN,NaN,NaN),columns_sums)
data <- rbind(data, Total)

for (x in 1:nrow(data)-1){
  for(y in 6:27){
    data[x,y] <- (data[x,y]/data[nrow(data),y])
  }
}
return(data)
}
data_experience_normalize <- normalization_signs(data_experience)

############ 2 combinations, all signs ##########

combination_signesx2 <- function(data,column_number){
combination260x2 <-combn(1:260,2)

sum_disease_vector260x2 = c()
for (x in 1:33670){
  sum_disease_vector260x2 <- append(sum_disease_vector260x2,data[combination260x2[1,x],column_number] + data[combination260x2[2,x],column_number] )
  }
combination260x2 <- rbind(combination260x2,sum_disease_vector260x2)
combination260x2 <- t(combination260x2)
sum_disease_ranking260x2 <- combination260x2[order(combination260x2[,3],decreasing=TRUE),]
colnames(sum_disease_ranking260x2)[3] = colnames(data)[column_number]
return(sum_disease_ranking260x2)
}

sum_disease_matrix260x2_final = c()

for (x in 6:27){
sum_disease_matrix260x2_final <- cbind(sum_disease_matrix260x2_final,combination_signesx2(data_experience_normalize,x))
}

############ 3 combinations ##########

combination_signesx3 <- function(data,column_number){
combination260x3 <-combn(1:260,3)
sum_disease_vector260x3 = c()
for (x in 1:33670){
sum_disease_vector260x3 <- append(sum_disease_vector260x3,data[combination260x3[1,x],column_number] + data[combination260x3[2,x],column_number] + data[combination260x3[3,x],column_number] )
  }
combination260x3 <- rbind(combination260x3,sum_disease_vector260x3)
combination260x3 <- t(combination260x3)
sum_disease_ranking260x3 <- combination260x3[order(combination260x3[,4],decreasing=TRUE),]
colnames(sum_disease_ranking260x3)[4] = colnames(data)[column_number]
return(sum_disease_ranking260x3)
}

sum_disease_matrix260x3_final = c()

for (x in 6:27){
sum_disease_matrix260x3_final <- cbind(sum_disease_matrix260x3_final,combination_signesx3(data_experience_normalize,x))
}


####PORSIACASO#####
# combination260x3 <-combn(1:260,3)
# sum_disease_vector260x3 = c()
# for (x in 1:2895620){
#   print(x)
#   sum_disease_vector260x3 <- append(sum_disease_vector260x3,data[combination260x3[1,x],6] + data[combination260x3[2,x],6] + data[combination260x3[3,x],6])
#   }
# combination260x3 <- rbind(combination260x3,sum_disease_vector260x3)
# combination260x3 <- t(combination260x3)
# combination260x3[order(combination260x3[,4],decreasing=TRUE),]

#### Patterns in SISTEM- ORGAN ##########

library("openxlsx")
data_experience <-openxlsx::read.xlsx("/home/gabi/MASTER/bio_info/M2/math/proyecto/SalmonDiseaseProject/DISEASES_MATRIX_English_01.xlsx")

normalization_systems <- function(data){
agregatte_vector<-aggregate(data[,6], list(data$System.or.organ), FUN=sum)
systems_table <- data.frame(agregatte_vector[,1])
colnames(systems_table)[1] = colnames(data)[1]


for (i in 6:27){
agregatte_vector<-aggregate(data[1:260,i], list(data$System.or.organ), FUN=sum)
systems_table <- cbind(systems_table, agregatte_vector[,2])
}            
colnames(systems_table) <- colnames(data[,5:27])

systems_table <- cbind(systems_table, Total = rowSums(systems_table[2:23]))

for (x in 1:nrow(systems_table)){
  for(y in 2:23){
    systems_table[x,y] <- (systems_table[x,y]/systems_table[x,24])
  }
}

systems_table_columns_sums = colSums(systems_table[,2:24])
systems_table_columns_sums
systems_table_columns_sums_Total = append(c(NaN),systems_table_columns_sums)
systems_table <- rbind(systems_table, systems_table_columns_sums_Total)

for (x in 1:nrow(systems_table)-1){
  for(y in 2:23){
    systems_table[x,y] <- (systems_table[x,y]/systems_table[nrow(systems_table),y])
  }
}
return(systems_table) 
}

systems_table <- normalization_systems(data_experience)

###### 2 combinations -  All Systems #######

combination_systemsx2 <- function(data,column_number){

  combination12x2 <-combn(1:12,2)
  sum_disease_vector12x2 = c()
  for (x in 1:ncol(combination12x2)){
    sum_disease_vector12x2 <- append(sum_disease_vector12x2,systems_table[combination12x2[1,x],column_number] + systems_table[combination12x2[2,x],column_number])
    }
  combination12x2 <- rbind(combination12x2,sum_disease_vector12x2)
  combination12x2 <- t(combination12x2)
  sum_systems_ranking12x2 <-combination12x2[order(combination12x2[,3],decreasing=TRUE),]
  colnames(sum_systems_ranking12x2)[3] = colnames(data)[column_number]
  return(sum_systems_ranking12x2)
}
sum_systems_matrix12x2_final = c()

for (x in 6:27){
sum_systems_matrix12x2_final <- cbind(sum_systems_matrix12x2_final,combination_systemsx2(systems_table,x))
}
# 3 combinations #

comb5 <-combn(1:12,3)
vector_loco4 = c()
for (x in 1:220){
  vector_loco4 <- append(vector_loco4,System_table[comb5[1,x],2] + System_table[comb5[2,x],2]+System_table[comb5[3,x],2])
  }
comb5.1 <- rbind(comb5,vector_loco4)
comb5.2 <- t(comb5.1)
comb5.2[order(comb5.2[,4],decreasing=TRUE),]

########  TYPE OF DISORDER ######

library("openxlsx")
data <-openxlsx::read.xlsx("/home/gabi/MASTER/bio_info/M2/math/proyecto/SalmonDiseaseProject/DISEASES_MATRIX_English_01.xlsx")

data$concatenated <-(paste(data$System.or.organ, "+" ,data$Organ, "+", data$Type.of.disorder))

agregatte_vector <- aggregate(data[,6], list(data$concatenated), FUN=sum)
Lesion_type_table <- data.frame(agregatte_vector[,1])

for (i in 6:27){
agregatte_vector <- aggregate(data[,i], list(data$concatenated), FUN=sum)
Lesion_type_table <- cbind(Lesion_type_table, agregatte_vector[,2])
}            

colnames(Lesion_type_table) <- colnames(data[,5:27])

Lesion_type_table_columns_sums = colSums(Lesion_type_table[,2:23])
Lesion_type_table_columns_sums
Lesion_type_table_columns_sums_Total = append(c(NaN),Lesion_type_table_columns_sums)
Lesion_type_table <- rbind(Lesion_type_table, Lesion_type_table_columns_sums_Total)
Lesion_type_table <- cbind(Lesion_type_table, Total = rowSums(Lesion_type_table[2:23]))

for (x in 1:nrow(Lesion_type_table)-1){
  for(y in 2:23){
    Lesion_type_table[x,y] <- (Lesion_type_table[x,y]/Lesion_type_table[x,24])
  }
}

# 2 combinations #
comb6 <-combn(1:76,2)
vector_loco5 = c()
for (x in 1:2850){
  vector_loco5 <- append(vector_loco5,Lesion_type_table[comb6[1,x],2] + Lesion_type_table[comb6[2,x],2])
  }
comb6.1 <- rbind(comb6,vector_loco5)
comb6.2 <- t(comb6.1)
comb6.2[order(comb6.2[,3],decreasing=TRUE),]

# 3 combinations #

comb7 <-combn(1:76,3)
vector_loco6 = c()
for (x in 1:70300){
  vector_loco6 <- append(vector_loco6,Lesion_type_table[comb7[1,x],2] + Lesion_type_table[comb7[2,x],2]+Lesion_type_table[comb7[3,x],2])
  }
comb7.1 <- rbind(comb7,vector_loco6)
comb7.2 <- t(comb7.1)
comb7.2[order(comb7.2[,4],decreasing=TRUE),]

### PATTERNS IN ENDEMIC VS EXOTIC #########


######## PATTERNS IN BACTERIAL ###########


######## PATTERNS IN VIRAL #########
s

```

